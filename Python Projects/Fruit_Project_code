import pandas as pd
import numpy as np
import random
from datetime import datetime, timedelta

def get_season(date):
    month = date.month
    if month in [12, 1, 2]:
        return "Winter"
    elif month in [3, 4, 5]:
        return "Spring"
    elif month in [6, 7, 8]:
        return "Summer"
    else:
        return "Fall"
        
        
        fruits = ["Apple", "Banana", "Mango", "Orange", "Strawberry", "Grapes",
          "Watermelon", "Mango", "DragonFruit", "Kiwi", "Pineapple",
          "Papaya", "Guava", "Coconut"]

regions = ["North", "South", "East", "West", "Tropical"]

data = []
start_date = datetime(2025, 1, 1)

for i in range(500):
    fruit = random.choice(fruits)
    region = random.choice(regions)
    date = start_date + timedelta(days=random.randint(0, 364))

    season = get_season(date)   

    units_sold = random.randint(50, 500)
    unit_price = round(random.uniform(0.5, 3.0), 2)
    revenue = round(units_sold * unit_price, 2)

    data.append([
        fruit,
        region,
        date.strftime("%Y-%m-%d"),
        units_sold,
        unit_price,
        revenue,
        season
    ])
       
# Create DataFrame
df = pd.DataFrame(data, columns=["Fruit", "Region", "Date", "Units_Sold", "Unit_Price", "Revenue", "Season"])
df.head(35)


Analysis #1     Total Revenue by Region

import seaborn as sns
import matplotlib.pyplot as plt

region_revenue = df.groupby("Region", as_index=False)["Revenue"].sum()

region_colors = {
    "North": "blue",
    "South": "orange",
    "Tropical": "green",
    "East": "purple",
    "West": "yellow"
}

plt.figure(figsize=(8,6))
sns.barplot(
    data=region_revenue,
    x="Region",
    y="Revenue",
    hue="Region",
    palette=region_colors,
    legend=False
)

plt.title("Total Revenue by Region")
plt.ylabel("Revenue ($)")
plt.xlabel("Region")
plt.show()


 Analysis #2 Comparison between Average Revenue between Tropical vs Non-Tropical Fruits

df["Fruit_Type"] = df["Fruit"].apply(lambda x: "Tropical" if x in ["Mango", "Pineapple", "Papaya", "Guava", "Coconut", "Dragon Fruit"] else "Non-Tropical")

plt.figure(figsize=(8,6))
sns.barplot(
    data=df.groupby("Fruit_Type", as_index=False)["Revenue"].mean(),
    x="Fruit_Type", y="Revenue", hue= "Fruit_Type", palette="viridis"
)
plt.title("Average Revenue: Tropical vs Non-Tropical Fruits")
plt.ylabel("Average Revenue ($)")
plt.xlabel("Fruit Type")
plt.show()


Analysis #3   Monthly Revenue Trend Throughout the Year

import matplotlib.pyplot as plt
import pandas as pd

df["Date"] = pd.to_datetime(df["Date"])

df["Month"] = df["Date"].dt.month

monthly_revenue = (
    df.groupby("Month", as_index=False)["Revenue"]
    .sum()
)

plt.figure(figsize=(10,6))
plt.plot(monthly_revenue["Month"], monthly_revenue["Revenue"], marker="o")

plt.title("Monthly Revenue Trend Throughout the Year")
plt.xlabel("Month")
plt.ylabel("Total Revenue $")
plt.xticks(range(1, 13))
plt.grid(True)

plt.show() 


Analysis #4 To identify key revenue drivers, fruit-level performance was analyzed by comparing total revenue and total units sold for each fruit type.

import matplotlib.pyplot as plt

fruit_summary = (
    df.groupby("Fruit", as_index=False)
    .agg({
        "Revenue": "sum",
        "Units_Sold": "sum"
    })
)

fruit_summary = fruit_summary.sort_values("Revenue", ascending=True)

plt.figure(figsize=(10,6))
plt.bar(fruit_summary["Fruit"], fruit_summary["Revenue"])

plt.title("Total Revenue by Fruit Type")
plt.xlabel("Fruit")
plt.ylabel("Total Revenue ($)")
plt.xticks(rotation=45)
plt.show()


#Part 2 By Unit Sold
plt.figure(figsize=(10,6))
plt.bar(fruit_summary["Fruit"], fruit_summary["Units_Sold"])

plt.title("Total Units Sold by Fruit Type")
plt.xlabel("Fruit")
plt.ylabel("Total Units Sold")
plt.xticks(rotation=45)
plt.show()

